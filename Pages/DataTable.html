<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRUD-DATATABLES</title>
   
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <!-- DataTable.css -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.min.css">

    <!-- Icons Bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">

    
    
    
</head>
<body>

    <div class="container">
        <h1 class="mt-5">DataTable JS</h1>
        <h4>API: <a href="https://jsonplaceholder.typicode.com/users" target="_blank">https://jsonplaceholder.typicode.com/users</a></h3>
        <div class="row mb-3 d-flex justify-content-between">
            <div class="col-6 col-lg-2">
                <a href="../index.html" class="btn btn-danger form-control">
                    <i class="bi bi-back"></i>
                    Regresar</a>
            </div>
            <div class="col-6 col-lg-2 text-right">
                <button 
                    type="button" 
                    class="btn btn-primary w-100"
                    data-bs-toggle="modal"
                    data-bs-target="#miModal"
                    id="btnCrear"
                >
                <i class="bi bi-plus-circle-fill"></i> Crear
            </button>
            </div>
        </div>

        <!-- Table -->
        <div class="row">
            <div class="col">
                <div class="table-responsive">
                    <table  id="myTable" class="table table-bordered table-striped">
                        <thead>
                            <tr>
                                <th>id</th>
                                <th>name</th>
                                <th>username</th>
                                <th>email</th>
                                <th>phone</th>
                                <th>website</th>
                                <th>Info</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </div>
    

    <!-- Modal -->
    <div class="modal fade" id="miModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title " id="exampleModalLabel">Capture</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form action="POST" id="formulario">

                  <label for="name">name:</label>
                  <input type="text" name="name" id="name" class="form-control">

                  <label for="username">username:</label>
                  <input type="text" name="username" id="username" class="form-control">

                  <label for="email">email:</label>
                  <input type="text" name="email" id="email" class="form-control">

                  <label for="phone">phone:</label>
                  <input type="text" name="phone" id="phone" class="form-control">

                  <label for="website">website:</label>
                  <input type="text" name="website" id="website" class="form-control">


              </form>
            </div>
            <div class="modal-footer">
              <input type="hidden" name="id_usuario" id="id_usuario">
              <input type="hidden" name="operacion" id="operacion">
              <button type="button" class="btn btn-primary">Save changes</button>
            </div>
          </div>
        </div>
      </div>


      
      <!-- JQuery -->
      <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

      <!-- DataTable.js -->
      <script src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.min.js"></script>

      <!-- Bootstrap JS -->
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

    
    
    
    

    <script>

        function getJsonById(id) {

            fetch("https://jsonplaceholder.typicode.com/users?id=" + id)
            .then(res => {
                    // pasamos respuesta al siguiente .then si res.OK es true, si no al catch.
                return res.ok ? res.json() : Promise.reject(res);
            })
            .then(json => {
                alert(JSON.stringify(json));
                
            })
            .catch(err => {
                console.log("Estamos en el catch", err);
                let message = err.statusText || "Ocurrió un error.";
            })

        };
                    
        $(document).ready(function(){

            let miJson = {};
                 
            
            //$('#myTable').DataTable();
            function LoadTable(){
                $('#myTable').DataTable({
                    "data" : miJson,
                    "columns": 
                    [
                        { "data": "id" },
                        { "data": "name" },
                        { "data": "username" },
                        { "data": "email" },
                        { "data": "phone" },
                        { "data": "website" },
                        {
                            "data": "id", "width": "50px", "render": function(data){
                                return '<button class="btn btn-success" onclick="getJsonById(' + data + ')">Info</button>'
                            }
                        }
                    ]
                });

              


            }

           

            function getJson() {

                fetch("https://jsonplaceholder.typicode.com/users")
                .then(res => {
                        // pasamos respuesta al siguiente .then si res.OK es true, si no al catch.
                    return res.ok ? res.json() : Promise.reject(res);
                })
                .then(json => {
                    miJson = json;
                    LoadTable();
                })
                .catch(err => {
                    console.log("Estamos en el catch", err);
                    let message = err.statusText || "Ocurrió un error.";
                })

            };

           

            getJson();

        });

      
        
    </script>
</body>
</html>